# 基于DAMON内核子系统，利用机器学习优化缓存页压缩与回收阈值

## 0. Ref

![封面](.\Image\屏幕截图 2025-12-07 134057.png)

![Study case](.\Image\屏幕截图 2025-12-07 134151.png)

## 1. DAMON（Data Access MONitor）简介

​       DAMON 是 Linux 内核中用于**高效监控进程内存访问模式**的子系统。它的主要目标是克服传统内存监控方法（如 `/proc/<pid>/smaps` 或页表分析）带来的巨大性能开销。

### DAMON 的工作原理

DAMON 采用**抽样（Sampling）**和**分区域（Region-based）**的方法来确定内存的“冷热”：

- **区域划分：** DAMON 不监控每一个内存页，而是将进程的虚拟内存空间划分为多个**区域 (Regions)**。
- **抽样监测：** 在每个固定的时间间隔内，DAMON 会对这些区域进行一次**访问抽样**。它通过检查区域内的某个代表性内存页的访问位 (Access Bit) 来判断该区域最近是否被访问过。
- **冷热判断：** 通过持续的抽样和统计，DAMON 能够积累每个区域的**访问频率 (Access Frequency)** 和**未访问时长 (Age)**，从而判断哪些区域是“热”（经常访问）的，哪些是“冷”（很少访问）的。

### DAMOS (DAMON-based Operation Schemes)

DAMON 提供了数据，而 **DAMOS** 则提供了**行动**。DAMOS 是基于 DAMON 监控数据执行特定操作的框架。DAMOS 允许用户定义一个或多个 **"Scheme"（方案/策略）**，每个方案包含三个主要要素：

| **要素**                                 | **描述**                                                     | **在实验中的意义**                                           |
| :--------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **目标访问模式 (Target Access Pattern)** | 识别哪些区域需要被操作。这由 DAMON 提供的 **size**, **age**, **frequency** 等参数定义。 | **目标：** 识别 MySQL 中那些 *age* 很大（很久没用）且 *frequency* 很低（不常访问）的内存区域。 |
| **操作 (Operation)**                     | 对满足条件的区域执行的具体内存操作。                         | **操作：** **页面换出 (PAGEOUT)** 或 **页面回收 (RECLAIM)**。 |
| **目标设备 (Destination)**               | 操作完成后页面的去向。                                       | **去向：** 将冷页换出到 **zram** 设备中。                    |